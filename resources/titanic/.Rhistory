values  <- gene.getValues( gene )
return( t( as.numeric( values[ which( x=row.names( values ) == "FPKM"), ] ) ) )
}
m <- sapply( geneList, gene.getFPKM, simplify=T )
head( m )
gene.getFPKM  <- function( gene ) {
values  <- gene.getValues( gene )
return( t( as.numeric( values[ which( x=row.names( values ) == "FPKM"), ] ) ) )
}
m <- sapply( geneList, gene.getFPKM, simplify=T )
head( m )
m <- sapply( geneList, gene.getFPKM )
head( m )
summary( m )
m <- matrix( nrow=length( names ), ncol=length( geneList ) )
summary( m )
m <- matrix( nrow=length( names ), ncol=length( geneList ) )
summary( m )
rm( m )
m <- matrix( nrow=length( names ), ncol=length( geneList ) )
summary( m )
m <- matrix( ncol=length( names ), nrow=length( geneList ) )
m
summary( m )
m[1,]
m <- matrix( ncol=length( names ), nrow=length( geneList ) )
for( i in 1:length( m ) ) {
m[i,] <- gene.getFPKM( geneList[[ i ]] )
}
length( geneList )
m <- matrix( ncol=length( names ), nrow=length( geneList ) )
for( i in 1:length( geneList ) ) {
m[i,] <- gene.getFPKM( geneList[[ i ]] )
}
geneList[[ 1 ]]
m[1,]
m[100,]
m[11,]
for( i in 1:length( m[1,] ) ) {
print( i )
}
for( i in 1:length( m[,1] ) ) {
print( i )
}
onlyNAs  <- rep(0,length( m[,1] ) )
m[1,]
is.na( m[1,] )
which( is.na( m[1,] ) )
length( which( is.na( m[1,] ) ) )
length( which( is.na( m[1,] ) ) ) == length( length( m[1,] ) )
for( i in 1:length( m[,1] ) ) {
onlyNAs[ i ]  <- ( length( which( is.na( m[i,] ) ) ) == length( length( m[i,] ) ) )
}
head( onlyNAs )
onlyNAs  <- rep(FALSE,length( m[,1] ) )
for( i in 1:length( m[,1] ) ) {
onlyNAs[ i ]  <- ( length( which( is.na( m[i,] ) ) ) == length( length( m[i,] ) ) )
}
summary( onlyNAs )
head( onlyNAs )
head( onlyNAs, 1000 )
for( i in 1:length( m[,1] ) ) {
print( length( which( is.na( m[i,] ) ) ) == length( length( m[i,] ) ) )
}
length( which( is.na( m[10,] ) ) )
m[10,]
m[100,]
length( which( is.na( m[100,] ) ) )
length( which( is.na( m[100,] ) ) ) == length( m[i,] )
for( i in 1:length( m[,1] ) ) {
print( length( which( is.na( m[i,] ) ) ) == length( m[i,] ) )
}
onlyNAs  <- rep(FALSE,length( m[,1] ) )
for( i in 1:length( m[,1] ) ) {
print( length( which( is.na( m[i,] ) ) ) == length( m[i,] ) )
}
onlyNAs  <- rep(FALSE,length( m[,1] ) )
for( i in 1:length( m[,1] ) ) {
onlyNAs <- length( which( is.na( m[i,] ) ) ) == length( m[i,] )
}
summary( onlyNAs )
onlyNAs  <- rep(FALSE,length( m[,1] ) )
for( i in 1:length( m[,1] ) ) {
onlyNAs[ i ] <- length( which( is.na( m[i,] ) ) ) == length( m[i,] )
}
onlyNAs
m[ !onlyNAs, ]
###########################
# FPKM values
###########################
###########################
#  Load data
###########################
source("~/Dropbox/AlternativeSplicing/temp/scripts/gene.R")
#names  <- c("library1","library2","library3","library4","library5","library6","library7","library8","library9","library10","library11","library12","library13","library14","library15","library16" )
names  <- c("RS11_BC1_Pts2","RS11_BC2_Pts3","RS11_BC3_HC35","RS11_BC4_Pts39","RS11_BC5_Pts1","RS11_BC6_HC34","RS11_BC7_HC24","RS11_BC8_Pts50","RS11_BC9_Pts36","RS11_BC10_Pts47","RS11_BC11_Pts38","RS11_BC12_HC31","RS11_BC13_Pts9","RS11_BC14_Pts40","RS11_BC15_MEC_C5","RS11_BC16_MEC_scramble" )
fpkmList   <- as.list( rep(NA,length(names)) )
fpkmList[[ 1 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/1_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 2 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/2_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 3 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/3_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 4 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/4_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 5 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/5_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 6 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/6_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 7 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/7_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 8 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/8_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 9 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/9_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 10 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/10_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 11 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/11_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 12 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/12_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 13 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/13_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 14 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/14_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 15 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/15_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 16 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/16_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
ids  <- unique( c( fpkmList[[ 1 ]]$tracking_id, fpkmList[[ 2 ]]$tracking_id, fpkmList[[ 3 ]]$tracking_id, fpkmList[[ 4 ]]$tracking_id, fpkmList[[ 5 ]]$tracking_id, fpkmList[[ 6 ]]$tracking_id, fpkmList[[ 7 ]]$tracking_id, fpkmList[[ 8 ]]$tracking_id, fpkmList[[ 9 ]]$tracking_id, fpkmList[[ 10 ]]$tracking_id, fpkmList[[ 11 ]]$tracking_id, fpkmList[[ 12 ]]$tracking_id, fpkmList[[ 13 ]]$tracking_id, fpkmList[[ 14 ]]$tracking_id, fpkmList[[ 15 ]]$tracking_id, fpkmList[[ 16 ]]$tracking_id ) )
ids  <- ids[ grep(pattern="EN",x=ids ) ]
geneList  <- sapply( ids, gene.constructor, names=names )
head( fpkmList[[ 1 ]], 100)
###########################
# FPKM values
###########################
###########################
#  Load data
###########################
source("~/Dropbox/AlternativeSplicing/temp/scripts/gene.R")
#names  <- c("library1","library2","library3","library4","library5","library6","library7","library8","library9","library10","library11","library12","library13","library14","library15","library16" )
names  <- c("RS11_BC1_Pts2","RS11_BC2_Pts3","RS11_BC3_HC35","RS11_BC4_Pts39","RS11_BC5_Pts1","RS11_BC6_HC34","RS11_BC7_HC24","RS11_BC8_Pts50","RS11_BC9_Pts36","RS11_BC10_Pts47","RS11_BC11_Pts38","RS11_BC12_HC31","RS11_BC13_Pts9","RS11_BC14_Pts40","RS11_BC15_MEC_C5","RS11_BC16_MEC_scramble" )
fpkmList   <- as.list( rep(NA,length(names)) )
fpkmList[[ 1 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/1_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 2 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/2_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 3 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/3_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 4 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/4_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 5 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/5_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 6 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/6_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 7 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/7_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 8 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/8_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 9 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/9_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 10 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/10_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 11 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/11_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 12 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/12_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 13 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/13_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 14 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/14_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 15 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/15_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 16 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/16_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
ids  <- unique( c( fpkmList[[ 1 ]]$tracking_id, fpkmList[[ 2 ]]$tracking_id, fpkmList[[ 3 ]]$tracking_id, fpkmList[[ 4 ]]$tracking_id, fpkmList[[ 5 ]]$tracking_id, fpkmList[[ 6 ]]$tracking_id, fpkmList[[ 7 ]]$tracking_id, fpkmList[[ 8 ]]$tracking_id, fpkmList[[ 9 ]]$tracking_id, fpkmList[[ 10 ]]$tracking_id, fpkmList[[ 11 ]]$tracking_id, fpkmList[[ 12 ]]$tracking_id, fpkmList[[ 13 ]]$tracking_id, fpkmList[[ 14 ]]$tracking_id, fpkmList[[ 15 ]]$tracking_id, fpkmList[[ 16 ]]$tracking_id ) )
ids  <- ids[ grep(pattern="EN",x=ids ) ]
geneList  <- sapply( ids, gene.constructor, names=names )
# Hash positions of genes
map <- new.env(hash=T, parent=emptyenv())
for( i in 1:length( geneList ) ) {
map[[ gene.getId( geneList[[ i ]] ) ]]  <- i
}
head( fpkmList[[ 1 ]], 100)
for( i in 1:length( fpkmList ) ) {
libraryNumber  <- i
print( i )
#   for( j in 1:length( fpkmList[[ libraryNumber ]] ) ) {
#     row  <- fpkmList[[ libraryNumber ]][ j, ]
#     #print( row )
#     id  <- as.character( row[ 1 ] )
#     #print( id )
#     geneIndex  <- map[[ id ]]
#     if( length( geneIndex ) != 0 ) {
#       fpkm <- row[ 10 ]
#       fpkm_conf_lo <- row[ 11 ]
#       fpkm_conf_hi <- row[ 12 ]
#       gene  <- geneList[[ geneIndex ]]
#       geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
#     }
#   }
}
i <- 1
for( j in 1:length( fpkmList[[ libraryNumber ]] ) ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
print( row )
#     id  <- as.character( row[ 1 ] )
#     #print( id )
#     geneIndex  <- map[[ id ]]
#     if( length( geneIndex ) != 0 ) {
#       fpkm <- row[ 10 ]
#       fpkm_conf_lo <- row[ 11 ]
#       fpkm_conf_hi <- row[ 12 ]
#       gene  <- geneList[[ geneIndex ]]
#       geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
#     }
}
length( fpkmList[[ libraryNumber ]] )
source("~/Dropbox/AlternativeSplicing/temp/scripts/gene.R")
names  <- c("RS11_BC1_Pts2","RS11_BC2_Pts3","RS11_BC3_HC35","RS11_BC4_Pts39","RS11_BC5_Pts1","RS11_BC6_HC34","RS11_BC7_HC24","RS11_BC8_Pts50","RS11_BC9_Pts36","RS11_BC10_Pts47","RS11_BC11_Pts38","RS11_BC12_HC31","RS11_BC13_Pts9","RS11_BC14_Pts40","RS11_BC15_MEC_C5","RS11_BC16_MEC_scramble" )
fpkmList   <- as.list( rep(NA,length(names)) )
length( fpkmList )
fpkmList[[ 1 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/1_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
length( fpkmList )
fpkmList[[ 2 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/2_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 3 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/3_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 4 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/4_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 5 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/5_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 6 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/6_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 7 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/7_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 8 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/8_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 9 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/9_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 10 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/10_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 11 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/11_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 12 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/12_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 13 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/13_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 14 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/14_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 15 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/15_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 16 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/16_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
length( fpkmList )
head( fpkmList[[ 1 ]], 10 )
head( fpkmList[[ 1 ]] )
head( fpkmList[[ 11 ]] )
head( fpkmList[[ 12 ]] )
head( fpkmList[[ 13 ]] )
head( fpkmList[[ 14 ]] )
head( fpkmList[[ 15 ]] )
head( fpkmList[[ 16 ]] )
ids  <- unique( c( fpkmList[[ 1 ]]$tracking_id, fpkmList[[ 2 ]]$tracking_id, fpkmList[[ 3 ]]$tracking_id, fpkmList[[ 4 ]]$tracking_id, fpkmList[[ 5 ]]$tracking_id, fpkmList[[ 6 ]]$tracking_id, fpkmList[[ 7 ]]$tracking_id, fpkmList[[ 8 ]]$tracking_id, fpkmList[[ 9 ]]$tracking_id, fpkmList[[ 10 ]]$tracking_id, fpkmList[[ 11 ]]$tracking_id, fpkmList[[ 12 ]]$tracking_id, fpkmList[[ 13 ]]$tracking_id, fpkmList[[ 14 ]]$tracking_id, fpkmList[[ 15 ]]$tracking_id, fpkmList[[ 16 ]]$tracking_id ) )
length( ids )
ids  <- ids[ grep(pattern="EN",x=ids ) ]
length( ids )
geneList  <- sapply( ids, gene.constructor, names=names )
length( ids )
length( fpkmList )
# Hash positions of genes
map <- new.env(hash=T, parent=emptyenv())
for( i in 1:length( geneList ) ) {
map[[ gene.getId( geneList[[ i ]] ) ]]  <- i
}
length( fpkmList[[ 1 ]] )
length( fpkmList[[ 1 ]][1,] )
length( fpkmList[[ 1 ]][,1] )
for( j in 1:length( fpkmList[[ libraryNumber ]][,1] ) ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
print( row )
#     id  <- as.character( row[ 1 ] )
#     #print( id )
#     geneIndex  <- map[[ id ]]
#     if( length( geneIndex ) != 0 ) {
#       fpkm <- row[ 10 ]
#       fpkm_conf_lo <- row[ 11 ]
#       fpkm_conf_hi <- row[ 12 ]
#       gene  <- geneList[[ geneIndex ]]
#       geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
#     }
}
for( j in 1:10 ) ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
#print( row )
id  <- as.character( row[ 1 ] )
#print( id )
geneIndex  <- map[[ id ]]
#     if( length( geneIndex ) != 0 ) {
#       fpkm <- row[ 10 ]
#       fpkm_conf_lo <- row[ 11 ]
#       fpkm_conf_hi <- row[ 12 ]
#       gene  <- geneList[[ geneIndex ]]
#       geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
#     }
}
for( j in 1:10 ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
#print( row )
id  <- as.character( row[ 1 ] )
#print( id )
geneIndex  <- map[[ id ]]
#     if( length( geneIndex ) != 0 ) {
#       fpkm <- row[ 10 ]
#       fpkm_conf_lo <- row[ 11 ]
#       fpkm_conf_hi <- row[ 12 ]
#       gene  <- geneList[[ geneIndex ]]
#       geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
#     }
}
for( j in 1:10 ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
#print( row )
id  <- as.character( row[ 1 ] )
print( id )
geneIndex  <- map[[ id ]]
#     if( length( geneIndex ) != 0 ) {
#       fpkm <- row[ 10 ]
#       fpkm_conf_lo <- row[ 11 ]
#       fpkm_conf_hi <- row[ 12 ]
#       gene  <- geneList[[ geneIndex ]]
#       geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
#     }
}
for( j in 1:10 ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
#print( row )
id  <- as.character( row[ 1 ] )
#print( id )
geneIndex  <- map[[ id ]]
if( length( geneIndex ) != 0 ) {
fpkm <- row[ 10 ]
fpkm_conf_lo <- row[ 11 ]
fpkm_conf_hi <- row[ 12 ]
gene  <- geneList[[ geneIndex ]]
print( gene.getId( gene ) )
geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
}
}
for( i in 1:length( fpkmList ) ) {
libraryNumber  <- i
for( j in 1:length( fpkmList[[ libraryNumber ]][,1] ) ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
#print( row )
id  <- as.character( row[ 1 ] )
#print( id )
geneIndex  <- map[[ id ]]
if( length( geneIndex ) != 0 ) {
fpkm <- row[ 10 ]
fpkm_conf_lo <- row[ 11 ]
fpkm_conf_hi <- row[ 12 ]
gene  <- geneList[[ geneIndex ]]
#print( gene.getId( gene ) )
geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
}
}
}
source("~/Dropbox/AlternativeSplicing/temp/scripts/gene.R")
#names  <- c("library1","library2","library3","library4","library5","library6","library7","library8","library9","library10","library11","library12","library13","library14","library15","library16" )
names  <- c("RS11_BC1_Pts2","RS11_BC2_Pts3","RS11_BC3_HC35","RS11_BC4_Pts39","RS11_BC5_Pts1","RS11_BC6_HC34","RS11_BC7_HC24","RS11_BC8_Pts50","RS11_BC9_Pts36","RS11_BC10_Pts47","RS11_BC11_Pts38","RS11_BC12_HC31","RS11_BC13_Pts9","RS11_BC14_Pts40","RS11_BC15_MEC_C5","RS11_BC16_MEC_scramble" )
fpkmList   <- as.list( rep(NA,length(names)) )
fpkmList[[ 1 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/1_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 2 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/2_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
ids  <- unique( c( fpkmList[[ 1 ]]$tracking_id, fpkmList[[ 2 ]]$tracking_id ) )
ids  <- ids[ grep(pattern="EN",x=ids ) ]
geneList  <- sapply( ids, gene.constructor, names=names )
# Hash positions of genes
map <- new.env(hash=T, parent=emptyenv())
for( i in 1:length( geneList ) ) {
map[[ gene.getId( geneList[[ i ]] ) ]]  <- i
}
# Load FPKMs
for( i in 1:length( fpkmList ) ) {
libraryNumber  <- i
for( j in 1:length( fpkmList[[ libraryNumber ]][,1] ) ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
#print( row )
id  <- as.character( row[ 1 ] )
#print( id )
geneIndex  <- map[[ id ]]
if( length( geneIndex ) != 0 ) {
fpkm <- row[ 10 ]
fpkm_conf_lo <- row[ 11 ]
fpkm_conf_hi <- row[ 12 ]
gene  <- geneList[[ geneIndex ]]
#print( gene.getId( gene ) )
geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
}
}
}
fpkmList
length( fpkmList )
rm( list=ls() )
source("~/Dropbox/AlternativeSplicing/temp/scripts/gene.R")
#names  <- c("library1","library2","library3","library4","library5","library6","library7","library8","library9","library10","library11","library12","library13","library14","library15","library16" )
#names  <- c("RS11_BC1_Pts2","RS11_BC2_Pts3","RS11_BC3_HC35","RS11_BC4_Pts39","RS11_BC5_Pts1","RS11_BC6_HC34","RS11_BC7_HC24","RS11_BC8_Pts50","RS11_BC9_Pts36","RS11_BC10_Pts47","RS11_BC11_Pts38","RS11_BC12_HC31","RS11_BC13_Pts9","RS11_BC14_Pts40","RS11_BC15_MEC_C5","RS11_BC16_MEC_scramble" )
names  <- c("RS11_BC1_Pts2","RS11_BC2_Pts3" )
fpkmList   <- as.list( rep(NA,length(names)) )
fpkmList[[ 1 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/1_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 2 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/2_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 3 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/3_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 4 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/4_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 5 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/5_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 6 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/6_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 7 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/7_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 8 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/8_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 9 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/9_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 10 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/10_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 11 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/11_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 12 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/12_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 13 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/13_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 14 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/14_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 15 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/15_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
# fpkmList[[ 16 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/16_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
#ids  <- unique( c( fpkmList[[ 1 ]]$tracking_id, fpkmList[[ 2 ]]$tracking_id, fpkmList[[ 3 ]]$tracking_id, fpkmList[[ 4 ]]$tracking_id, fpkmList[[ 5 ]]$tracking_id, fpkmList[[ 6 ]]$tracking_id, fpkmList[[ 7 ]]$tracking_id, fpkmList[[ 8 ]]$tracking_id, fpkmList[[ 9 ]]$tracking_id, fpkmList[[ 10 ]]$tracking_id, fpkmList[[ 11 ]]$tracking_id, fpkmList[[ 12 ]]$tracking_id, fpkmList[[ 13 ]]$tracking_id, fpkmList[[ 14 ]]$tracking_id, fpkmList[[ 15 ]]$tracking_id, fpkmList[[ 16 ]]$tracking_id ) )
ids  <- unique( c( fpkmList[[ 1 ]]$tracking_id, fpkmList[[ 2 ]]$tracking_id ) )
ids  <- ids[ grep(pattern="EN",x=ids ) ]
geneList  <- sapply( ids, gene.constructor, names=names )
# Hash positions of genes
map <- new.env(hash=T, parent=emptyenv())
for( i in 1:length( geneList ) ) {
map[[ gene.getId( geneList[[ i ]] ) ]]  <- i
}
# Load FPKMs
for( i in 1:length( fpkmList ) ) {
libraryNumber  <- i
for( j in 1:length( fpkmList[[ libraryNumber ]][,1] ) ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
#print( row )
id  <- as.character( row[ 1 ] )
#print( id )
geneIndex  <- map[[ id ]]
if( length( geneIndex ) != 0 ) {
fpkm <- row[ 10 ]
fpkm_conf_lo <- row[ 11 ]
fpkm_conf_hi <- row[ 12 ]
gene  <- geneList[[ geneIndex ]]
#print( gene.getId( gene ) )
geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
}
}
}
gene.getFPKM( geneList[[ 1 ]])
gene.getFPKM( geneList[[ 2 ]])
gene.getFPKM( geneList[[ 3 ]])
gene.getFPKM( geneList[[ 4 ]])
gene.getFPKM( geneList[[ 5 ]])
gene.getFPKM( geneList[[ 100 ]])
gene.getFPKM( geneList[[ 101 ]])
gene.getFPKM( geneList[[ 102 ]])
gene.getFPKM( geneList[[ 103 ]])
gene.getFPKM( geneList[[ 104 ]])
a  <- sapply( geneList, gene.getFPKM )
head( a )
a  <- sapply( geneList, gene.getFPKM, simplify=T )
head( a )
m <- matrix( ncol=length( names ), nrow=length( geneList ) )
for( i in 1:length( geneList ) ) {
m[i,] <- gene.getFPKM( geneList[[ i ]] )
}
head( m )
head( m, 100 )
onlyNAs  <- rep(FALSE,length( m[,1] ) )
for( i in 1:length( m[,1] ) ) {
onlyNAs[ i ] <- length( which( is.na( m[i,] ) ) ) == length( m[i,] )
}
onlyNAs
summary( onlyNAs )
rm( list=ls() )
source("~/Dropbox/AlternativeSplicing/temp/scripts/gene.R")
#names  <- c("library1","library2","library3","library4","library5","library6","library7","library8","library9","library10","library11","library12","library13","library14","library15","library16" )
names  <- c("RS11_BC1_Pts2","RS11_BC2_Pts3","RS11_BC3_HC35","RS11_BC4_Pts39","RS11_BC5_Pts1","RS11_BC6_HC34","RS11_BC7_HC24","RS11_BC8_Pts50","RS11_BC9_Pts36","RS11_BC10_Pts47","RS11_BC11_Pts38","RS11_BC12_HC31","RS11_BC13_Pts9","RS11_BC14_Pts40","RS11_BC15_MEC_C5","RS11_BC16_MEC_scramble" )
#names  <- c("RS11_BC1_Pts2","RS11_BC2_Pts3" )
fpkmList   <- as.list( rep(NA,length(names)) )
fpkmList[[ 1 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/1_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 2 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/2_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 3 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/3_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 4 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/4_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 5 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/5_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 6 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/6_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 7 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/7_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 8 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/8_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 9 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/9_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 10 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/10_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 11 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/11_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 12 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/12_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 13 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/13_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 14 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/14_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 15 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/15_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
fpkmList[[ 16 ]] <- read.table("~/Dropbox/AlternativeSplicing/temp/fpkms/16_genes.fpkm_tracking",head=T,sep="\t",colClasses=c(rep("character",9),rep("numeric",3),"character"))
ids  <- unique( c( fpkmList[[ 1 ]]$tracking_id, fpkmList[[ 2 ]]$tracking_id, fpkmList[[ 3 ]]$tracking_id, fpkmList[[ 4 ]]$tracking_id, fpkmList[[ 5 ]]$tracking_id, fpkmList[[ 6 ]]$tracking_id, fpkmList[[ 7 ]]$tracking_id, fpkmList[[ 8 ]]$tracking_id, fpkmList[[ 9 ]]$tracking_id, fpkmList[[ 10 ]]$tracking_id, fpkmList[[ 11 ]]$tracking_id, fpkmList[[ 12 ]]$tracking_id, fpkmList[[ 13 ]]$tracking_id, fpkmList[[ 14 ]]$tracking_id, fpkmList[[ 15 ]]$tracking_id, fpkmList[[ 16 ]]$tracking_id ) )
#ids  <- unique( c( fpkmList[[ 1 ]]$tracking_id, fpkmList[[ 2 ]]$tracking_id ) )
ids  <- ids[ grep(pattern="EN",x=ids ) ]
geneList  <- sapply( ids, gene.constructor, names=names )
# Hash positions of genes
map <- new.env(hash=T, parent=emptyenv())
for( i in 1:length( geneList ) ) {
map[[ gene.getId( geneList[[ i ]] ) ]]  <- i
}
# Load FPKMs
for( i in 1:length( fpkmList ) ) {
libraryNumber  <- i
for( j in 1:length( fpkmList[[ libraryNumber ]][,1] ) ) {
row  <- fpkmList[[ libraryNumber ]][ j, ]
#print( row )
id  <- as.character( row[ 1 ] )
#print( id )
geneIndex  <- map[[ id ]]
if( length( geneIndex ) != 0 ) {
fpkm <- row[ 10 ]
fpkm_conf_lo <- row[ 11 ]
fpkm_conf_hi <- row[ 12 ]
gene  <- geneList[[ geneIndex ]]
#print( gene.getId( gene ) )
geneList[[ geneIndex ]]  <- gene.addColumn( gene=gene, col=libraryNumber, fpkm=fpkm, fpkm_conf_lo=fpkm_conf_lo, fpkm_conf_hi=fpkm_conf_hi )
}
}
}
4&20
4^20
sqrt(3.618142801E9)
rm( list=;ls() )
rm( list=ls() )
d$AgeYoungOnly  <- d$Age
###########################
# Explore titanic data
###########################
write  <- FALSE
###########################
# Load libraries and set working directory
###########################
library( ggplot2 )
library( reshape )
setwd("~/workspace/Kaggle/resources/titanic/")
###########################
# Clean data for R
# 1. Read data
# 2. Replace '?' used in Weka for NAs
# 3. Make sure that features have the right class
###########################
d <- read.csv("trainClean.csv",head=T)
d[ d == "?" ] <- NA
d$Survived  <- as.factor( d$Survived ) #
d$Pclass  <- as.factor( d$Pclass )
d$Age <- as.numeric( as.character( d$Age ) )
d$AgeBinned  <- as.numeric( cut( x=as.numeric( d$Age ), breaks=seq(from=0,to=100,by=20), labels=seq( from=10,to=90,by=20) ) )
d$AgeYoungOnly  <- d$Age
d$AgeYoungOnly[ d$AgeYoungOnly > 20 ]
d$AgeYoungOnly[ d$AgeYoungOnly > 20 ]  <- NA
